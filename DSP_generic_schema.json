{
	"$schema": "http://json-schema.org/draft-07/schema#",
	"title": "Metaschema for DSP",
	"type": "object",
	"properties": {
		"dsp": {
			"type": "object",
			"properties": {
				"uuid": {
					"type": "string"
				},
				"metadata": {
					"type": "object",
					"properties": {
						"title": {
							"type": "string"
						},
						"published": {
							"type": "string"
						},
						"last-modified": {
							"type": "string"
						},
						"version": {
							"type": "string"
						},
						"dsp-model-version": {
							"type": "string"
						},
						"revisions": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"title": {
										"type": "string"
									},
									"published": {
										"type": "string"
									},
									"description": {
										"type": "string"
									},
									"version": {
										"type": "string"
									},
									"dsp-model-version": {
										"type": "string"
									},
									"modified-by": {
										"type": "object",
										"properties": {
											"party-uuid": {
												"type": "string"
											}
										},
										"required": [
											"role-id",
											"party-uuid"
										]
									},
									"links": {
										"type": "array",
										"items": {
											"type": "object",
											"properties": {
												"href": {
													"type": "string"
												},
												"rel": {
													"type": "string"
												},
												"text": {
													"type": "string"
												}
											},
											"required": [
												"href"
											]
										}
									}
								},
								"required": [
									"version"
								]
							}
						},
						"links": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"href": {
										"type": "string"
									},
									"rel": {
										"type": "string"
									},
									"text": {
										"type": "string"
									}
								},
								"required": [
									"href"
								]
							}
						},
						"roles": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"id": {
										"type": "string"
									},
									"title": {
										"type": "string"
									},
									"description": {
										"type": "string"
									}
								},
								"required": [
									"id",
									"title"
								]
							}
						},
						"parties": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"uuid": {
										"type": "string"
									},
									"type": {
										"type": "string"
									},
									"name": {
										"type": "string"
									},
									"email-addresses": {
										"type": "array",
										"items": {
											"type": "string"
										}
									},
									"telephone-numbers": {
										"type": "array",
										"items": {
											"type": "string"
										}
									},
									"member-of-organizations": {
										"type": "array",
										"items": {
											"type": "string"
										}
									}
								},
								"required": [
									"uuid",
									"type"
								]
							}
						},
						"responsible-parties": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"role-id": {
										"type": "string"
									},
									"party-uuid": {
										"type": "string"
									}
								},
								"required": [
									"role-id",
									"party-uuid"
								]
							}
						}
					},
					"required": [
						"title",
						"last-modified",
						"version",
						"dsp-model-version",
						"links"
					]
				},
				"local-definitions": {
					"type": "object",
					"properties": {
						"components": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"uuid": {
										"type": "string"
									},
									"type": {
										"type": "string"
									},
									"title": {
										"type": "string"
									},
									"description": {
										"type": "string"
									},
									"purpose": {
										"type": "string"
									},
									"props": {
										"type": "array",
										"items": {
											"type": "object",
											"properties": {
												"name": {
													"type": "string"
												},
												"value": {
													"type": "string"
												}
											},
											"required": [
												"name",
												"value"
											]
										}
									},
									"links": {
										"type": "array",
										"items": {
											"type": "object",
											"properties": {
												"href": {
													"type": "string"
												},
												"rel": {
													"type": "string"
												},
												"media-type": {
													"type": "string"
												}
											},
											"required": [
												"href"
											]
										}
									},
									"status": {
										"type": "object",
										"properties": {
											"state": {
												"type": "string"
											}
										},
										"required": [
											"state"
										]
									}
								},
								"required": [
									"uuid",
									"type",
									"title",
									"description",
									"links",
									"status"
								]
							}
						},
						"assessment-assets": {
							"type": "object",
							"properties": {
								"components": {
									"type": "array",
									"items": {
										"type": "object",
										"properties": {
											"uuid": {
												"type": "string"
											},
											"type": {
												"type": "string"
											},
											"title": {
												"type": "string"
											},
											"description": {
												"type": "string"
											},
											"purpose": {
												"type": "string"
											},
											"status": {
												"type": "object",
												"properties": {
													"state": {
														"type": "string"
													}
												},
												"required": [
													"state"
												]
											}
										},
										"required": [
											"uuid",
											"type",
											"title",
											"description",
											"status"
										]
									}
								},
								"assessment-platforms": {
									"type": "array",
									"items": {
										"type": "object",
										"properties": {
											"uuid": {
												"type": "string"
											},
											"title": {
												"type": "string"
											}
										},
										"required": [
											"uuid"
										]
									}
								}
							},
							"required": []
						},
						"observations": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"uuid": {
										"type": "string"
									},
									"title": {
										"type": "string"
									},
									"description": {
										"type": "string"
									},
									"methods": {
										"type": "array",
										"items": {
											"type": "string"
										}
									},
									"origins": {
										"type": "array",
										"items": {
											"type": "object",
											"properties": {
												"type": {
													"type": "string"
												},
												"actor-uuid": {
													"type": "string"
												}
											},
											"required": [
												"type",
												"actor-uuid"
											]
										}
									},
									"subjects": {
										"type": "array",
										"items": {
											"type": "object",
											"properties": {
												"subject-uuid": {
													"type": "string"
												},
												"type": {
													"type": "string"
												}
											},
											"required": [
												"subject-uuid",
												"type"
											]
										}
									},
									"relevant-evidence": {
										"type": "array",
										"items": {
											"type": "object",
											"properties": {
												"description": {
													"type": "string"
												},
												"links": {
													"type": "array",
													"items": {
														"type": "object",
														"properties": {
															"href": {
																"type": "string"
															},
															"rel": {
																"type": "string"
															},
															"media-type": {
																"type": "string"
															}
														},
														"required": [
															"href"
														]
													}
												}
											},
											"required": [
												"description",
												"links"
											]
										}
									},
									"collected": {
										"type": "string"
									},
									"expires": {
										"type": "string"
									}
								},
								"required": [
									"uuid",
									"title",
									"description",
									"methods",
									"collected"
								]
							}
						},
						"risks": {
							"type": "array",
							"items": {
								"type": "object",
								"properties": {
									"uuid": {
										"type": "string"
									},
									"title": {
										"type": "string"
									},
									"description": {
										"type": "string"
									},
									"links": {
										"type": "array",
										"items": {
											"type": "object",
											"properties": {
												"href": {
													"type": "string"
												},
												"rel": {
													"type": "string"
												},
												"media-type": {
													"type": "string"
												}
											},
											"required": [
												"href",
												"rel",
												"media-type"
											]
										}
									},
									"status": {
										"type": "string"
									},
									"origin": {
										"type": "object",
										"properties": {
											"actors": {
												"type": "array",
												"items": {
													"type": "object",
													"properties": {
														"type": {
															"type": "string"
														},
														"actor-uuid": {
															"type": "string"
														}
													},
													"required": [
														"type",
														"actor-uuid"
													]
												}
											}
										},
										"required": [
											"actors"
										]
									},
									"threat-ids": {
										"type": "array",
										"items": {
											"type": "object",
											"properties": {
												"system": {
													"type": "string"
												},
												"href": {
													"type": "string"
												}
											},
											"required": [
												"href"
											]
										}
									},
									"characterizations": {
										"type": "array",
										"items": {
											"type": "object",
											"properties": {
												"facets": {
													"type": "array",
													"items": {
														"type": "object",
														"properties": {
															"name": {
																"type": "string"
															},
															"system": {
																"type": "string"
															},
															"value": {
																"type": "string"
															}
														},
														"required": [
															"name",
															"system",
															"value"
														]
													}
												}
											},
											"required": [
												"facets"
											]
										}
									},
									"deadline": {
										"type": "string"
									},
									"remediations": {
										"type": "array",
										"items": {
											"type": "object",
											"properties": {
												"uuid": {
													"type": "string"
												},
												"lifecycle": {
													"type": "string"
												},
												"title": {
													"type": "string"
												},
												"description": {
													"type": "string"
												},
												"props": {
													"type": "array",
													"items": {
														"type": "object",
														"properties": {
															"name": {
																"type": "string"
															},
															"value": {
																"type": "string"
															}
														},
														"required": [
															"name",
															"value"
														]
													}
												},
												"links": {
													"type": "array",
													"items": {
														"type": "object",
														"properties": {
															"href": {
																"type": "string"
															},
															"rel": {
																"type": "string"
															},
															"media-type": {
																"type": "string"
															}
														},
														"required": [
															"href"
														]
													}
												}
											},
											"required": [
												"uuid",
												"lifecycle",
												"title",
												"description"
											]
										}
									},
									"risk-log": {
										"type": "object",
										"properties": {
											"entries": {
												"type": "array",
												"items": {
													"type": "object",
													"properties": {
														"uuid": {
															"type": "string"
														},
														"title": {
															"type": "string"
														},
														"description": {
															"type": "string"
														},
														"props": {
															"type": "array",
															"items": {
																"type": "object",
																"properties": {
																	"name": {
																		"type": "string"
																	},
																	"value": {
																		"type": "string"
																	}
																},
																"required": [
																	"name",
																	"value"
																]
															}
														},
														"logged-by": {
															"type": "string"
														},
														"start": {
															"type": "string"
														},
														"end": {
															"type": "string"
														},
														"status-change": {
															"type": "string"
														}
													},
													"required": [
														"uuid",
														"start"
													]
												}
											}
										},
										"required": [
											"entries"
										]
									},
									"related-observations": {
										"type": "array",
										"items": {
											"type": "object",
											"properties": {
												"observation-uuid": {
													"type": "string"
												}
											},
											"required": [
												"observation-uuid"
											]
										}
									}
								},
								"required": [
									"uuid",
									"title",
									"description",
									"status",
									"origin"
								]
							}
						}
					},
					"required": []
				},
				"import-ar": {
					"type": "object",
					"properties": {
						"href": {
							"type": "string"
						},
						"remarks": {
							"type": "string"
						}
					},
					"required": [
						"href"
					]
				}
			},
			"required": [
				"uuid",
				"metadata",
				"system-id"
			]
		}
	},
	"required": [
		"dsp"
	]

}
